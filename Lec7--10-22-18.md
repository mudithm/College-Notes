<h1>Lecture 7</h1>

---

<h4>How to install Software</h4>

  * Windows
      - installshield, windows installer
  * Linux
      - rpm(redhat package manager)
          + Red Hat linux (.rpm)
          + kind of the equivalent to windows
      - `apt-get` (Advanced package tool)
          + from the terminal
          + debian linux, ubuntu linux (`.deb`)
          + must be run with admin privileges (`sudo`, `su`, etc)
          + `sudo apt-get install <package name>` 
      - good old build process
          + configure, make, make install
          + for stuff off of github, etc
          + open source projects

---

<h4>Decompressing files</h4>

  * generally, linux programs come in the tarball format `.tgz`, `.tar.gz` etc 
  * Decompressing filess in the current directory:
      - `tar -xzvf filename.tar.gz` 
          + `x` specifies extract rather than compress
          + `z` use gzip format for extracting/compressing
          + `v` verbose -- shows progress, etc
          + `f` file -- must be followed by a path to a file. Must also be at the end of all other options (needs to have a file immediately afterwards)

---

<h4>Compilation Process (C++)</h4>

  1. C++ Preprocessor
     - Takes care of header files and macros
     - creates an expanded source code file, with the header files literally copied in to the `#include` statments, and the macros literally replaced with their values. (and some other stuff)

  2. Compiler
     - Checks for errors and converts the expanded source code into assembly language
     - creates a file with a `.s` extension
     - optimizations take place here

  3. Assembler
     - Converts this into binary code, with a `.o` extension 

  4. Linker
     - Resolves dependencies, libraries, references, etc
     - outputs the final executable

---

<h4>Command line compilation</h4>

  * for `c`: `gcc` 
  * for `c++`: `g++` 
  * Same syntax for both
  * Example:
      - `gcc file.c file1.c file2.c -o shop` 
      - will combine the three files into an executable called `shop` (if possible) 
  * What if we change one of the header or source files?
      - we have to recompile the whole thing
      - To save time when recompiling, you can use the `-c` option and then recompile. The `-c` flag stops before the linking stage, leaving the `.o` files
      - Then, you will only have to recompile the files that were modified, and then run the linker again. Saves time for large-scale projects
      - `gcc -c file.c file2.c file3.c` to create the object files
      - `gcc file.o file2.o file3.o -o shop` to create the executable from these object files
  * If you modify a header file, every file that includes it or that includes a header that includes it (recursively) must be recompiled. This can take forever for large projects, and can be very tedious to do by hand

---

<h4>To solve this problem -- <code>make</code></h4>

  * `make` is a utility for managing large projects
  * compiles files and keeps them up to date
  * efficient compilation (only files that need to be recompiled)

```make

#Makefile

all: shops # usually first

item.o: item.c item.h   # items to the right of the colon are prerequisites
    gcc -c item.c

shoppingList.o: shoppingList.c item.h shoppingList.h
    gcc -c shoppingList.c

# ....

shop: item.c shoppingList.c #...
    gcc -o shop item.c shoppingList.c #...

clean:
    rm -f item.o shoppingList.o shop    # or however many object files there are

```


```shell

# in the terminal:
<user@server>  make #requires makefile

<user@server>  make -f file #specified makefile

```

  * By default, `make` runs target `'all'`
  * `make shop` would go to the line with `shop:` and execute recursively from there (sees that shop needs `item.o`, and jumps to that line, etc)
  * `make clean` performs the last line, removing all the object files and the executable.
  * `make` decides what need to be recompiled based on the timestamps of the files it looks at

---

<h4>Build Process</h4>

  * `configure`
      - gathers data about your system, libraries, capabilities, etc
      - creates a makefile
  * `make`
      - compiles all the progrm code and creates executables in current temp directory
  * `make install` 
      - searches for the `install` label in the makefile
      - copies the created executables into system directories, etc

---

<h3>Lab 3</h3>

  * Coreutils 8.29 has a problem
      - Option -a always overrides option -A regardless of which is given first
      - option -A should remove . and .. from output
  * want the option -A to override any earlier pa
  * fix the program by patching
  * `ls -a -A ` should not include `.` or `..` 
  * `ls -A -a` should include `.` and `..` 

